const redis = require("ioredis"); const r = new redis(process.env.REDIS_URL); r.on("connect", () => { console.log("Connected"); r.multi().set("protocol:volume24h", "15.75").set("protocol:tvl", "3250.50").set("protocol:volume24hChange", "8.25").exec().then(() => r.publish("metrics:updated", JSON.stringify({ entityType: "protocol", entityId: "protocol", metricType: "metrics_update", timestamp: Date.now() }))).then(n => console.log(`Published to ${n} subscribers`)).then(() => r.quit()).catch(console.error); }); r.on("error", e => { console.error(e); r.quit(); });
